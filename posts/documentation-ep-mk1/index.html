<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> EP-MK1 Documentation | Mike Moreno DSP </title> <meta name="author" content="Miguel Moreno"> <meta name="description" content=""> <meta name="keywords" content="dsp, audio-plugins, music-tech, sound-design"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link defer href="/assets/css/bootstrap-toc.min.css?6f5af0bb9aab25d79b2448143cbeaa88" rel="stylesheet"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%A5%B8&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://mikemorenodsp.github.io/posts/documentation-ep-mk1/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav sticky-bottom-footer"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> Mike Moreno DSP </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About </a> </li> <li class="nav-item "> <a class="nav-link" href="/software/">Software </a> </li> <li class="nav-item "> <a class="nav-link" href="/learning/">Learning </a> </li> <li class="nav-item active"> <a class="nav-link" href="/posts/index.html">Posts </a> </li> <li class="nav-item "> <a class="nav-link" href="/portfolio/">Portfolio </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">CV </a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">Repositories </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="row"> <div class="col-sm-9"> <div class="post"> <header class="post-header"> <h1 class="post-title">EP-MK1 Documentation</h1> <p class="post-meta"> Created in November 12, 2019 </p> <p class="post-tags"> <i class="fa-solid fa-calendar fa-sm"></i> 2019   ·   <i class="fa-solid fa-hashtag fa-sm"></i> plugins   <i class="fa-solid fa-hashtag fa-sm"></i> documentation   <i class="fa-solid fa-hashtag fa-sm"></i> synthesis   <i class="fa-solid fa-hashtag fa-sm"></i> physical modelling </p> </header> <article class="post-content"> <div id="markdown-content"> <p>EP-MK1 is a synthesized electric piano made with Pure Data and Camomile.</p> <p>The resulting sound is a combination of four layers:</p> <ul> <li> <strong>Hammer Layer</strong>: the excitation source for the tone bar and tine layer.</li> <li> <strong>Tone Bar Layer</strong>: the main component, a resonator filter oscillating at the fundamental frequency.</li> <li> <strong>Tine Layer</strong>: two resonators with user-defined frequency ratios for each filter.</li> <li> <strong>Pickup Layer</strong>: A sum of the three previous layers through a filtered nonlinear distortion.</li> </ul> <h2 id="hammer-layer">Hammer Layer</h2> <p>The <strong>hammer layer</strong> was synthesized using a high-precision audio ramp generator object <code class="language-plaintext highlighter-rouge">vline~</code> going through a cosine waveshaper <code class="language-plaintext highlighter-rouge">cos~</code>. The result is a pulse with a length in milliseconds equal to one period of our fundamental frequency.</p> <div class="row" style="text-align: center;"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/posts/ep-mk1/01-Hammer-480.webp 480w,/assets/img/posts/ep-mk1/01-Hammer-800.webp 800w,/assets/img/posts/ep-mk1/01-Hammer-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/posts/ep-mk1/01-Hammer.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" style=" max-width: 284px; " loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <h2 id="tone-bar-layer">Tone Bar Layer</h2> <p>The tone bar’s only component is a resonant band-pass filter with constant skirt, better known as a <strong>resonator</strong> in modal synthesis. Sending a source of excitation to the resonator will output a decaying sine wave oscillating at the filter’s frequency. The sine wave’s decay time is determined by the filter’s resonance (Q).</p> <p>In this instrument the abstraction <code class="language-plaintext highlighter-rouge">b.resonator~</code> from the mkmr library is being used, but there are plenty of resonators to choose from for Pure Data:</p> <ul> <li> <code class="language-plaintext highlighter-rouge">resonator~</code> from the else library: <a href="https://github.com/porres/pd-else/releases" rel="external nofollow noopener" target="_blank">Download at GitHub</a> or Deken</li> <li> <code class="language-plaintext highlighter-rouge">filtercoeff.mmb</code> or <code class="language-plaintext highlighter-rouge">filtercoeff.mmb~</code> set at “resonant” from the mmb library: <a href="https://github.com/dotmmb/mmb" rel="external nofollow noopener" target="_blank">Download at GitHub</a> </li> <li> <code class="language-plaintext highlighter-rouge">hv.filter</code> set at “bandpass 1” from the heavy library: <a href="https://github.com/enzienaudio/heavylib" rel="external nofollow noopener" target="_blank">Download at GitHub</a> </li> </ul> <p>The inlets parameters for <code class="language-plaintext highlighter-rouge">b.resonator~</code> are the following:</p> <ol> <li>signal - signal to be filtered or excite the resonator.</li> <li>float - sets the central cutoff frequency in hertz.</li> <li>float - sets the filter’s resonance (Q).</li> <li>bang - reinitialize the filter’s internal state.</li> </ol> <div class="row" style="text-align: center;"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/posts/ep-mk1/02-Tone-Bar-480.webp 480w,/assets/img/posts/ep-mk1/02-Tone-Bar-800.webp 800w,/assets/img/posts/ep-mk1/02-Tone-Bar-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/posts/ep-mk1/02-Tone-Bar.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" style=" max-width: 461px; " loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <h2 id="tine-layer">Tine Layer</h2> <p>The bell-like sound in an Electric Piano comes from the <strong>tine layer</strong> which is composed of two resonators being excited by a filtered hammer. First, the hammer goes through a 2-pole high-pass filter to remove any unwanted low frequency content like thumps or clicks. Then, the resonator’s frequency ratios are set to 7 and 20 to generate those harmonics respectively. Finally, a volume parameter is recommended to control the level of “brightness”.</p> <div class="row" style="text-align: center;"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/posts/ep-mk1/03-Tine-Layer-480.webp 480w,/assets/img/posts/ep-mk1/03-Tine-Layer-800.webp 800w,/assets/img/posts/ep-mk1/03-Tine-Layer-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/posts/ep-mk1/03-Tine-Layer.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" style=" max-width: 490px; " loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <h2 id="pickup-layer">Pickup Layer</h2> <p>The pickup model is a parallel layer with nonlinear distortion. First, the sum of the three layers are sent to a 2-pole low-pass filter to get a cleaner tone on the higher notes. Then, the signal goes through a soft clipper which then goes a waveshaping process to enhance the even harmonics with the symmetry parameter. Finally, it gets normalized and rectified using a high-pass filter fundamental frequency.</p> <div class="row" style="text-align: center;"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/posts/ep-mk1/04-Pickup-Layer-480.webp 480w,/assets/img/posts/ep-mk1/04-Pickup-Layer-800.webp 800w,/assets/img/posts/ep-mk1/04-Pickup-Layer-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/posts/ep-mk1/04-Pickup-Layer.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" style=" max-width: 466px; " loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <h2 id="midi-implementation">MIDI Implementation</h2> <p>Lastly, MIDI is implemented to control the fundamental frequency, the hammer’s amplitude and the resonator’s decay and release time. It is important to reset the amplitude by setting it to zero on the first millisecond and then back to one on the second while simultaneously triggering the hammer and resetting the filters. This will avoid unwanted clicks and keep consistency at each trigger. Adding velocity control to the hammer’s amplitude will provide varied dynamics that affect the amount of harmonics produced by the pickup layer.</p> <div class="row" style="text-align: center;"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/posts/ep-mk1/05-MIDI-Implementation-480.webp 480w,/assets/img/posts/ep-mk1/05-MIDI-Implementation-800.webp 800w,/assets/img/posts/ep-mk1/05-MIDI-Implementation-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/posts/ep-mk1/05-MIDI-Implementation.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" style=" max-width: 622px; " loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <h2 id="references">References</h2> <ul> <li>Kurt James Werner. A Physically-Informed, Circuit-Bendable, Digital Model of the Roland TR-808 Bass Drum Circuit.</li> <li>Florian Pfeifle. Real-time Physical Model of a Wurlitzer and Rhodes Electric Piano. <a href="http://dafx17.eca.ed.ac.uk/papers/DAFx17_paper_79.pdf" rel="external nofollow noopener" target="_blank">http://dafx17.eca.ed.ac.uk/papers/DAFx17_paper_79.pdf</a> </li> <li>M. Muenster and F. Pfeifle. Non-Linear Behaviour in Sound Production of the Rhodes Piano. <a href="http://www.conforg.fr/isma2014/cdrom/data/articles/000062.pdf" rel="external nofollow noopener" target="_blank">http://www.conforg.fr/isma2014/cdrom/data/articles/000062.pdf</a> </li> <li>Kees van den Doel and Dinesh K. Pai. Modal Synthesis for Vibrating Objects. <a href="http://persianney.com/kvdoelcsubc/publications/modalpaper.pdf" rel="external nofollow noopener" target="_blank">http://persianney.com/kvdoelcsubc/publications/modalpaper.pdf</a> </li> <li>Applied Acoustic Systems. Lounge Lizard EP-4 In Depth. <a href="https://www.applied-acoustics.com/lounge-lizard-ep-4/in-depth/" rel="external nofollow noopener" target="_blank">https://www.applied-acoustics.com/lounge-lizard-ep-4/in-depth/</a> </li> </ul> </div> </article> </div> </div> <div class="col-sm-3"> <nav id="toc-sidebar" class="sticky-top"></nav> </div> </div> </div> <footer class="sticky-bottom mt-5" role="contentinfo"> <div class="container"> © Copyright 2025 Miguel Moreno. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script defer src="/assets/js/bootstrap-toc.min.js?c82ff4de8b0955d6ff14f5b05eed7eb6"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?70d799092f862ad98c7876aa47712e20"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/assets/js/search-data.js"></script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>